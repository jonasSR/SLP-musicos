<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ musico.nome }} | Pulsa Music Conect</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/perfil.css') }}">
</head>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<body class="profile-body">
    <div id="cursor-aura"></div>

    <main class="profile-split">
        <section class="artist-stage">
            <div class="artist-image-fixed" style="background-image: url('{{ musico.foto }}');">
                <div class="image-overlay"></div>
                <div class="artist-titles">
                    <h1 class="artist-main-name">{{ musico.nome }}</h1>
                </div>
            </div>
        </section>

    
        <section class="artist-details">
            <a href="/" class="btn-back-minimal">‚Üê VOLTAR</a>

        
            <div class="mobile-tabs">
                <button class="tab-btn active" onclick="showMobileTab(event, 'perfil')">
                    <i class="fas fa-user"></i> <span>Perfil</span>
                </button>
                <button class="tab-btn" onclick="showMobileTab(event, 'reserve')">
                    <i class="fas fa-calendar-alt"></i> <span>Reserve</span>
                </button>
                <button class="tab-btn" onclick="showMobileTab(event, 'agenda')">
                    <i class="fas fa-clock"></i> <span>Agenda</span>
                </button>
                <button class="tab-btn" onclick="showMobileTab(event, 'mensagens')">
                    <i class="fas fa-star"></i> <span>Seja f√£</span>
                </button>
            </div>

            <div class="content-scroll-box">
                
                <div id="perfil" class="tab-content active">
                     <div class="stats-bar-modern">
                <div class="stat-item" onclick="showMobileTab(event, 'mensagens')">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-content">
                        <span class="stat-value">{{ feedbacks|length }}</span>
                        <span class="stat-label">F√ÉS</span>
                    </div>
                </div>
                
                <div class="stat-divider"></div>
                
                <div class="stat-item">
                    <div class="stat-icon"><i class="fas fa-star"></i></div>
                    <div class="stat-content">
                        <span class="stat-value">{{ media_estrelas }}</span>
                        <span class="stat-label">AVALIA√á√ÉO</span>
                    </div>
                </div>
            </div>

            <div class="social-container" style="margin-bottom: 30px;">
                <h2 class="section-label">REDES SOCIAIS</h2>
                <div class="artist-social-links" style="display: flex; gap: 25px; margin-top: 15px;">
                    {% if musico.instagram %}
                        <a href="https://instagram.com/{{ musico.instagram|replace('@', '') }}" target="_blank" class="social-icon-link" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                    {% endif %}
                    {% if musico.facebook %}
                        <a href="{{ musico.facebook }}" target="_blank" class="social-icon-link" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    {% endif %}
                    {% if musico.youtube %}
                        <a href="{{ musico.youtube }}" target="_blank" class="social-icon-link" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    {% endif %}
                </div>
            </div>

            <hr class="section-divider">
                    <div class="info-group">
                        <h2 class="section-label">ESTILO</h2>
                        <span class="genre-badge">{{ musico.estilo }}</span>
                    </div>

                    <div class="bio-container">
                        <h2 class="section-label">DESCRI√á√ÉO</h2>
                        <div class="bio-text">
                            {{ musico.bio }}
                        </div>
                    </div>

                    <hr class="section-divider">

                    <div class="player-wrapper">
                        <h2 class="section-label">VIBRA√á√ÉO</h2>
                        <div class="glass-player">
                            <div class="play-icon">‚ñ∂</div>
                            <div class="wave-animation">
                                <span></span><span></span><span></span><span></span><span></span>
                            </div>
                            <p>PREVIEW SONORO DISPON√çVEL</p>
                        </div>
                    </div>
                </div>

                <hr class="section-divider">

                <div id="reserve" class="tab-content">
                    <div class="booking-glass-card">
                        <div class="card-header">
                            <h3>RESERVE A DATA</h3>
                            <p>Conecte este artista ao seu evento.</p>
                        </div>

                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                            <div id="flash-container">
                                {% for category, message in messages %}
                                <div class="alert-glass {{ category }}">
                                    <span class="icon">{% if category == 'success' %}‚ú®{% else %}‚ö†Ô∏è{% endif %}</span>
                                    {{ message }}
                                </div>
                                {% endfor %}
                            </div>
                            {% endif %}
                        {% endwith %}

                        <form action="/reservar" method="POST" class="profile-form">
                            <input type="hidden" name="musico_id" value="{{ id }}">
                            <div class="input-modern">
                                <label class="label-fixed">SEU NOME</label>
                                <input type="text" name="nome_solicitante" placeholder="Ex: Jo√£o Silva" required>
                            </div>
                            <div class="input-modern">
                                <label class="label-fixed">E-MAIL DE CONTATO</label>
                                <input type="email" name="email_solicitante" placeholder="seu@email.com" required>
                            </div>
                            <div class="input-modern">
                                <label class="label-fixed">WHATSAPP / TELEFONE</label>
                                <input type="tel" name="telefone_solicitante" placeholder="(12) 99999-9999" required>
                            </div>
                            <div class="input-modern">
                                <label class="label-fixed">DATA DO EVENTO</label>
                                <input type="text" name="data_evento" id="data-criativa" placeholder="Selecione o dia..." required>
                            </div>
                            <div class="input-modern">
                                <label class="label-fixed">LOCAL DO EVENTO</label>
                                <input type="text" name="local_evento" placeholder="Ex: Pousada do Sol ou Endere√ßo" required>
                            </div>

                            <div class="custom-select-container" id="tipoEventoContainer">
                                <label class="label-fixed">TIPO DE EVENTO</label>
                                <div class="select-trigger" onclick="toggleDropdown()">
                                    <span id="selected-text">Selecione o tipo...</span>
                                    <i class="arrow-icon">‚ñº</i>
                                </div>
                                <div class="select-options" id="optionsList">
                                    <div class="option-group">SOCIAIS</div>
                                    <div class="option-item" onclick="selectOption('Casamento', 'casamento')">Casamento</div>
                                    <div class="option-item" onclick="selectOption('Anivers√°rio', 'aniversario')">Anivers√°rio / Particular</div>
                                    <div class="option-group">P√öBLICOS E CULTURAIS</div>
                                    <div class="option-item" onclick="selectOption('Festival', 'festival')">Festival / Evento P√∫blico</div>
                                    <div class="option-item" onclick="selectOption('Carnaval', 'carnaval')">Carnaval / Bloco</div>
                                    <div class="option-group">COMERCIAIS</div>
                                    <div class="option-item" onclick="selectOption('Bar / Restaurante', 'bar')">Bar / Restaurante</div>
                                    <div class="option-group">DIVERSOS</div>
                                    <div class="option-item" onclick="selectOption('Outros', 'outro')">Outros</div>
                                </div>
                                <input type="hidden" name="tipo" id="tipo_hidden_input">
                            </div>

                            <button type="submit" class="btn-plasma" style="width: 100%; margin-top: 20px;">SOLICITAR OR√áAMENTO</button>
                        </form>
                    </div>
                </div>

                <hr class="section-divider">

                <div id="agenda" class="tab-content">
                    <div class="agenda-container">
                        <h2 class="section-label">AGENDA</h2>
                        <div class="agenda-list">
                            {% for show in agenda %}
                            <div class="agenda-item">
                                <div class="agenda-date-box">
                                    <span class="day">{{ show.data_dia }}</span>
                                    <span class="month">{{ show.data_mes }}</span>
                                </div>
                                <div class="agenda-info">
                                    {% if show.nome_festa %}
                                        <strong style="color: var(--primary); display: block; font-size: 0.8rem;">{{ show.nome_festa | upper }}</strong>
                                    {% endif %}
                                    <span class="venue-name">{{ show.local }}</span>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <span class="city-tag">{{ show.cidade }}</span>
                                        <span style="font-size: 0.75rem; color: #888;">üïí {{ show.horario }}</span>
                                    </div>
                                </div>
                                <div class="agenda-status">
                                    <div class="pulse-dot"></div> CONFIRMADO
                                </div>
                            </div>
                            {% else %}
                            <div class="empty-state">
                                <p>A agenda de shows est√° sendo atualizada.</p>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <br>
                <div id="mensagens" class="tab-content">
                        <div class="glass-card feedback-form-card" style="max-width: 500px; margin: 0 auto 40px auto;">
                            <h3>DEIXE SUA ESTRELA ‚ú®</h3>
                            <p>Conte para o artista o que achou da vibe!</p>
                            
                            <form id="form-feedback" class="feedback-grid">
                                <input type="hidden" name="artista_id" value="{{ id }}">
                                <input type="hidden" name="artista_email" value="{{ musico.dono_email }}">
                                
                                <div class="rating-selection">
                                    <input type="radio" name="estrelas" value="5" id="star5" checked><label for="star5">‚òÖ</label>
                                    <input type="radio" name="estrelas" value="4" id="star4"><label for="star4">‚òÖ</label>
                                    <input type="radio" name="estrelas" value="3" id="star3"><label for="star3">‚òÖ</label>
                                    <input type="radio" name="estrelas" value="2" id="star2"><label for="star2">‚òÖ</label>
                                    <input type="radio" name="estrelas" value="1" id="star1"><label for="star1">‚òÖ</label>
                                </div>

                                <div class="input-modern">
                                    <input type="text" name="nome_fa" placeholder="Seu nome ou apelido" required>
                                </div>

                                <div class="input-modern">
                                    <textarea name="comentario" placeholder="Escreva um depoimento..." rows="3" required></textarea>
                                </div>

                                <button type="submit" class="btn-plasma" id="btn-enviar-feedback" style="width: 100%;">ENVIAR NO MURAL</button>
                            </form>
                        </div>

                        <div class="mural-container">
                            <h2 class="mural-title">Comunidade</h2>

                            <div class="mural-scroll">
                                {% for feedback in feedbacks %}
                                <div class="vibe-card">
                                    <p class="vibe-text">{{ feedback.comentario }}</p>
                                    
                                    <hr class="vibe-divider">
                                    
                                    <div class="vibe-footer">
                                        <span class="vibe-user">@{{ feedback.nome_fa|replace(' ', '')|upper }}</span>
                                        <span class="vibe-rating">{{ feedback.estrelas }}‚òÖ</span>
                                    </div>
                                </div>
                                {% else %}
                                <div style="color: #444; font-size: 13px; padding: 20px;">
                                    Aguardando novas vibra√ß√µes...
                                </div>
                                {% endfor %}
                            </div>
                        </div>

            </div> </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/pt.js"></script>
    <script src="{{ url_for('static', filename='js/perfil.js') }}"></script>
</body>
</html>